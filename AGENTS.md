# AGENTS.md

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å HTTP-–∞—É–¥–∏–æ-—Å–µ—Ä–≤–µ—Ä –Ω–∞ —è–∑—ã–∫–µ Go, –∫–æ—Ç–æ—Ä—ã–π:

1. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –º—É–∑—ã–∫–∞–ª—å–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ (`.mp3`, `.aac`, `.ogg`)
2. –ü–µ—Ä–µ–∫–æ–¥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª –≤ `output_format` –∏ `output_bitrate` (–∏—Å–ø–æ–ª—å–∑—É—è `ffmpeg`)
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –≤ –∫—ç—à–µ (`cache_dir`)
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç `stream loop` –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–∏ (—Å—Ç–∞–Ω—Ü–∏–∏)
5. –û—Ç–¥–∞—ë—Ç –ø–æ—Ç–æ–∫ –ø–æ `/stream/:station`, —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
6. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã `/stations`, `/nowplaying/:station`, `/`

## üì¶ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏

- `github.com/gin-gonic/gin` ‚Äî HTTP —Å–µ—Ä–≤–µ—Ä
- `github.com/sirupsen/logrus` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `github.com/yosssi/gohtml` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è HTML
- `github.com/spf13/viper` ‚Äî –∫–æ–Ω—Ñ–∏–≥ –∏ ENV
- `os/exec` ‚Äî –≤—ã–∑–æ–≤ `ffmpeg`
- `bufio`, `os`, `io` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –∏ –±—É—Ñ–µ—Ä–∞–º–∏

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- `cmd/radiod/main.go` ‚Äî —Å—Ç–∞—Ä—Ç
- `internal/config/config.go` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `internal/convert/convert.go` ‚Äî –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∫–∏ —á–µ—Ä–µ–∑ `ffmpeg`
- `internal/stream/player.go` ‚Äî —Å—Ç—Ä–∏–º–∏–Ω–≥ –∏ –æ—á–µ—Ä–µ–¥—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- `internal/server/routes.go` ‚Äî –º–∞—Ä—à—Ä—É—Ç—ã Gin
- `web/index.gohtml` ‚Äî –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å `gohtml`

## üìÅ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

| Route | Method | Description |
|-------|--------|-------------|
| `/` | GET | HTML —Å–æ —Å–ø–∏—Å–∫–æ–º —Å—Ç–∞–Ω—Ü–∏–π |
| `/stations` | GET | JSON —Å–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω—Ü–∏–π |
| `/nowplaying/:station` | GET | JSON —Å —Ç–µ–∫—É—â–∏–º —Ç—Ä–µ–∫–æ–º |
| `/stream/:station` | GET | HTTP-–ø–æ—Ç–æ–∫ mp3 |

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞

–ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ `config.yaml`, –∑–∞—Ç–µ–º –∏–∑ ENV. –°–º. `README.md`.

## üê≥ Docker –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

–°–æ–∑–¥–∞–π `Dockerfile` —Å:

```Dockerfile
FROM golang:1.22-alpine
RUN apk add --no-cache ffmpeg
WORKDIR /app
COPY . .
RUN go build -o radiod ./cmd/radiod
EXPOSE 8080
CMD ["./radiod"]
```

## üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –°—Ç—Ä–∏–º–∏–Ω–≥ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π: –≤—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–æ—Ç–æ–∫
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `bufio` —Å —Ç–∞–π–º–µ—Ä–æ–º
- –ü–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ï—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è

## ‚ùå –ß—Ç–æ –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ICY/SHOUTcast
- WebSocket
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ –ø–æ—Ç–æ–∫–µ
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±—É—Ñ–µ—Ä/seek

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –ü–æ–º–µ—Å—Ç–∏ `.mp3` –≤ `music/pop`, `music/rock`
2. –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä
3. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ `http://localhost:8080/stream/pop` ‚Äî –Ω–∞—á–Ω—ë—Ç—Å—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä—å `http://localhost:8080/stations` –∏ `nowplaying/pop`

